<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ultraviolence | Archive</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Courier+Prime&family=Homemade+Apple&family=Special+Elite&family=Great+Vibes&family=Playfair+Display:ital@1&display=swap');

        :root {
            --cherry: #8b0000;
            --cream: #f4f1ea;
            --paper: #fdfaf0;
            --ink: #1a1a1a;
            --nav-h: 90px;
        }

        * { box-sizing: border-box; }
        body, html { margin: 0; padding: 0; background: #000; font-family: 'Courier Prime', monospace; overflow: hidden; }

        /* FIXED NAV - ENSURES NO OVERLAP */
        nav {
            height: var(--nav-h); width: 100%; background: #000; border-bottom: 2px solid var(--cherry);
            display: flex; justify-content: center; align-items: center; gap: 50px;
            position: fixed; top: 0; z-index: 1000;
        }
        nav button {
            background: transparent; border: none; color: white; font-family: 'Bebas Neue'; 
            font-size: 2.2rem; cursor: pointer; letter-spacing: 4px; transition: 0.3s;
        }
        nav button:hover { color: var(--cherry); }
        .active-nav { color: var(--cherry) !important; text-decoration: underline; }

        /* STAGE - PUSHED DOWN BY NAV HEIGHT */
        .stage { margin-top: var(--nav-h); height: calc(100vh - var(--nav-h)); position: relative; overflow-y: auto; background: var(--cream); }
        .view { display: none; min-height: 100%; width: 100%; }
        .view.active { display: block; }

        /* HOME SCREEN - FULLY VISIBLE TITLE */
        #home { background: #000; text-align: center; padding: 100px 20px; color: white; }
        .hero-title { font-family: 'Bebas Neue'; font-size: 9rem; letter-spacing: 15px; margin: 0; line-height: 0.9; }
        .scrapbook { display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; margin-top: 60px; }
        .polaroid { background: white; padding: 15px 15px 70px 15px; box-shadow: 0 20px 50px rgba(0,0,0,0.9); position: relative; transition: 0.5s; }
        .polaroid img { width: 250px; height: 320px; object-fit: cover; filter: grayscale(100%); }
        .polaroid p { position: absolute; bottom: 10px; left: 0; width: 100%; text-align: center; color: black; font-family: 'Bebas Neue'; font-size: 1.8rem; margin: 0; }
        .polaroid:hover { transform: scale(1.05); }
        .polaroid:hover img { filter: grayscale(0%); }

        /* PLANNER + CHECKLIST */
        .planner-wrap { display: flex; height: calc(100vh - var(--nav-h)); background: white; }
        .checklist { width: 300px; background: #f9f9f9; border-right: 2px solid #ddd; padding: 25px; display: flex; flex-direction: column; }
        .checklist h2 { font-family: 'Bebas Neue'; color: var(--cherry); margin-top: 0; }
        .todo-item { display: flex; align-items: center; gap: 10px; padding: 10px 0; border-bottom: 1px dashed #ccc; }
        
        .grid-main { flex-grow: 1; display: grid; grid-template-columns: 80px repeat(7, 1fr); overflow-y: auto; }
        .time-cell { height: 60px; border-bottom: 1px solid #eee; border-right: 1px solid #eee; text-align: right; padding: 5px; color: #aaa; font-size: 0.7rem; }
        .slot { height: 60px; border-bottom: 1px solid #eee; border-right: 1px solid #eee; position: relative; }
        .slot:hover { background: #fdf5f5; cursor: pointer; }
        .event-box { position: absolute; inset: 2px; background: var(--cherry); color: white; padding: 4px; font-size: 0.7rem; border-radius: 3px; }

        /* DIARY - CREAM PAGES & HINGE FLIP */
        .diary-wrap { display: flex; height: 100%; }
        .archive-side { width: 280px; background: #111; color: white; padding: 25px; border-right: 3px solid var(--cherry); }
        .archive-side select { width: 100%; padding: 10px; background: #222; color: white; border: 1px solid #444; margin-top: 10px; }

        .book-stage { flex-grow: 1; background: #1a1512; display: flex; align-items: center; justify-content: center; perspective: 2000px; position: relative; }
        .book { 
            width: 850px; height: 580px; background: var(--paper); display: flex; 
            box-shadow: 0 40px 100px rgba(0,0,0,0.7); position: relative; 
            transform-style: preserve-3d; transition: transform 0.6s;
        }
        .page { width: 50%; height: 100%; padding: 40px; border: 1px solid rgba(0,0,0,0.05); background: var(--paper); }
        .page-left { border-right: 2px solid rgba(0,0,0,0.1); }
        
        /* THE FLIP */
        .page-flip-anim { transform: rotateY(-10deg) scale(0.95); }

        textarea { 
            width: 100%; height: 100%; background: transparent; border: none; outline: none; resize: none; 
            font-size: 1.3rem; line-height: 35px;
            background-image: linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px); background-size: 100% 35px;
        }

        .controls { position: absolute; bottom: 20px; display: flex; gap: 400px; }
        .controls button { background: #000; color: white; border: none; padding: 10px 40px; font-family: 'Bebas Neue'; font-size: 1.5rem; cursor: pointer; }
    </style>
</head>
<body>

    <nav>
        <button onclick="tab('home')" id="n-home">HOME</button>
        <button onclick="tab('planner')" id="n-planner">PLANNER</button>
        <button onclick="tab('diary')" id="n-diary">THE DIARY</button>
    </nav>

    <div class="stage">
        <div id="home" class="view active">
            <h1 class="hero-title">ULTRAVIOLENCE</h1>
            <div class="scrapbook">
                <div class="polaroid"><img src="Cadillac.png"><p>GETAWAY</p></div>
                <div class="polaroid"><img src="lanacig.png"><p>LANA</p></div>
                <div class="polaroid"><img src="coke.png"><p>DIET SODA</p></div>
            </div>
        </div>

        <div id="planner" class="view">
            <div class="planner-wrap">
                <div class="checklist">
                    <h2>CHECKLIST</h2>
                    <input type="text" id="todoIn" placeholder="+ Task..." onkeydown="if(event.key==='Enter') addTodo()">
                    <div id="todoList" style="margin-top:20px;"></div>
                </div>
                <div class="grid-main" id="calGrid"></div>
            </div>
        </div>

        <div id="diary" class="view">
            <div class="diary-wrap">
                <div class="archive-side">
                    <h2>ARCHIVES</h2>
                    <select id="fnt" onchange="upStyle()">
                        <option value="'Homemade Apple'">Handwritten</option>
                        <option value="'Special Elite'">Grunge</option>
                        <option value="'Courier Prime'">Typewriter</option>
                        <option value="'Great Vibes'">Coquette Cursive</option>
                        <option value="'Playfair Display', serif">Vintage Italic</option>
                        <option value="'Bebas Neue'">Bold Display</option>
                    </select>
                    <input type="date" onchange="jump(this.value)" style="width:100%; margin-top:20px;">
                </div>
                <div class="book-stage">
                    <div class="book" id="bookObj">
                        <div class="page page-left">
                            <h3 id="dateH" style="font-family:'Bebas Neue'; color:var(--cherry); margin:0;"></h3>
                            <textarea id="textL" onkeyup="save()" placeholder="Write..."></textarea>
                        </div>
                        <div class="page">
                            <textarea id="textR" onkeyup="save()" placeholder="..."></textarea>
                        </div>
                    </div>
                    <div class="controls">
                        <button onclick="move(-1)">PREV</button>
                        <button onclick="move(1)">NEXT</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let day = new Date().toISOString().split('T')[0];
        let logs = JSON.parse(localStorage.getItem('uv_logs_vFinal')) || {};
        let plan = JSON.parse(localStorage.getItem('uv_plan_vFinal')) || {};
        let tasks = JSON.parse(localStorage.getItem('uv_todo_vFinal')) || [];

        function tab(t) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-nav'));
            document.getElementById(t).classList.add('active');
            document.getElementById('n-'+t).classList.add('active-nav');
            if(t === 'planner') { renderPlanner(); renderTodos(); }
            if(t === 'diary') renderDiary();
        }

        /* PLANNER */
        function renderPlanner() {
            const grid = document.getElementById('calGrid'); grid.innerHTML = "";
            for(let h=0; h<24; h++) {
                let time = document.createElement('div'); time.className = 'time-cell'; time.innerText = h+":00";
                grid.appendChild(time);
                for(let d=0; d<7; d++) {
                    let s = document.createElement('div'); s.className = 'slot';
                    let key = d+'-'+h;
                    if(plan[key]) s.innerHTML = `<div class="event-box" onclick="event.stopPropagation(); delEv('${key}')">${plan[key]}</div>`;
                    s.onclick = () => { let v = prompt("Meeting?"); if(v){ plan[key]=v; savePlan(); } };
                    grid.appendChild(s);
                }
            }
        }
        function savePlan() { localStorage.setItem('uv_plan_vFinal', JSON.stringify(plan)); renderPlanner(); }
        function delEv(k) { delete plan[k]; savePlan(); }

        function addTodo() {
            let i = document.getElementById('todoIn');
            if(i.value) { tasks.push({t: i.value, d: false}); i.value = ""; saveTodo(); }
        }
        function renderTodos() {
            const l = document.getElementById('todoList'); l.innerHTML = "";
            tasks.forEach((item, i) => {
                let d = document.createElement('div'); d.className = 'todo-item';
                d.innerHTML = `<input type="checkbox" ${item.d?'checked':''} onclick="toggleTodo(${i})"> <span>${item.t}</span>`;
                l.appendChild(d);
            });
        }
        function toggleTodo(i) { tasks[i].d = !tasks[i].d; saveTodo(); }
        function saveTodo() { localStorage.setItem('uv_todo_vFinal', JSON.stringify(tasks)); renderTodos(); }

        /* DIARY */
        function renderDiary() {
            document.getElementById('dateH').innerText = new Date(day).toLocaleDateString('en-US', {month:'long', day:'numeric'}).toUpperCase();
            let data = logs[day] || {l:"", r:""};
            document.getElementById('textL').value = data.l;
            document.getElementById('textR').value = data.r;
            upStyle();
        }
        function save() {
            logs[day] = { l: document.getElementById('textL').value, r: document.getElementById('textR').value };
            localStorage.setItem('uv_logs_vFinal', JSON.stringify(logs));
        }
        function move(n) {
            save();
            const book = document.getElementById('bookObj');
            book.classList.add('page-flip-anim');
            setTimeout(() => {
                let d = new Date(day); d.setDate(d.getDate() + n);
                day = d.toISOString().split('T')[0];
                renderDiary();
                book.classList.remove('page-flip-anim');
            }, 300);
        }
        function upStyle() {
            const f = document.getElementById('fnt').value;
            document.querySelectorAll('textarea').forEach(t => t.style.fontFamily = f);
        }
        function jump(v) { day = v; renderDiary(); }

        tab('home');
    </script>
</body>
</html>
