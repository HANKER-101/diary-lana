<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ultraviolence | Archive</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Courier+Prime&family=Homemade+Apple&family=Special+Elite&family=Playfair+Display:ital,wght@1,900&display=swap');

        :root {
            --cherry: #8b0000;
            --cream: #f4f1ea;
            --ink: #1a1a1a;
            --nav-h: 100px;
        }

        /* 1. PREVENT OVERLAP: Body is a flex column */
        body, html { 
            margin: 0; padding: 0; height: 100%; width: 100%; 
            background: #000; font-family: 'Courier Prime', monospace; overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* 2. NAVIGATION BAR: Constant height */
        nav {
            height: var(--nav-h); background: #000; border-bottom: 3px solid var(--cherry);
            display: flex; justify-content: center; align-items: center; gap: 40px;
            flex-shrink: 0; z-index: 100;
        }
        nav button {
            background: transparent; border: 2px solid transparent; color: white; 
            font-family: 'Bebas Neue'; font-size: 2rem; cursor: pointer; letter-spacing: 3px;
            padding: 5px 15px; transition: 0.3s;
        }
        nav button:hover { color: var(--cherry); border-color: var(--cherry); }
        .active-nav { color: var(--cherry) !important; background: rgba(139, 0, 0, 0.1); }

        /* 3. MAIN CONTENT: Fills remaining space */
        .main-container { flex-grow: 1; position: relative; overflow: hidden; background: var(--cream); }
        .view { 
            display: none; height: 100%; width: 100%; 
            position: absolute; top: 0; left: 0; box-sizing: border-box; 
        }
        .view.active { display: flex; }

        /* HOME PAGE: Fixed title padding */
        #home { background: #000; color: white; flex-direction: column; align-items: center; padding-top: 40px; }
        .hero-title { font-family: 'Bebas Neue'; font-size: 9rem; letter-spacing: 15px; margin: 0; line-height: 1; }
        .polaroid-row { display: flex; gap: 20px; margin-top: 40px; }
        .polaroid { 
            background: white; padding: 10px 10px 40px 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
            transition: 0.5s; position: relative;
        }
        .polaroid img { width: 200px; height: 260px; object-fit: cover; filter: grayscale(100%); }
        /* TITLE AT BOTTOM */
        .polaroid span { 
            position: absolute; bottom: 10px; left: 0; width: 100%;
            text-align: center; color: #000; font-family: 'Bebas Neue'; font-size: 1.2rem;
        }
        .polaroid:hover { transform: scale(1.05) rotate(0deg) !important; }
        .polaroid:hover img { filter: grayscale(0%); }

        /* DIARY: Sidebar and Book */
        .diary-layout { display: flex; width: 100%; height: 100%; }
        .sidebar { 
            width: 300px; background: #000; color: white; padding: 30px; 
            display: flex; flex-direction: column; gap: 15px; flex-shrink: 0;
            border-right: 1px solid var(--cherry); box-sizing: border-box;
        }
        .sidebar h2 { font-family: 'Bebas Neue'; color: var(--cherry); font-size: 2.5rem; margin: 0; }
        .sidebar label { font-size: 0.7rem; letter-spacing: 2px; }
        .sidebar select, .sidebar input { 
            background: #111; color: white; border: 1px solid #333; padding: 10px; width: 100%; 
        }

        .book-stage { 
            flex-grow: 1; background: #130d0a; display: flex; align-items: center; 
            justify-content: center; perspective: 1500px; position: relative;
        }
        /* ACTUAL PAGE TURN ANIMATION */
        .book { 
            width: 800px; height: 550px; background: var(--paper); display: flex;
            box-shadow: 0 30px 60px rgba(0,0,0,0.7); transition: transform 0.6s ease-in-out;
            transform-style: preserve-3d;
        }
        .turning { transform: rotateY(-15deg) scale(0.9) translateX(-50px); opacity: 0.5; }

        .page { 
            width: 50%; padding: 40px; box-sizing: border-box;
            background-image: linear-gradient(#e5e5e5 1px, transparent 1px); background-size: 100% 30px;
        }
        .page-left { border-right: 2px solid rgba(0,0,0,0.1); }
        textarea { 
            width: 100%; height: 100%; background: transparent; border: none; 
            outline: none; resize: none; line-height: 30px; font-size: 1.1rem; 
        }

        /* PLANNER: REAL GOOGLE GRID */
        .planner-grid { 
            display: grid; grid-template-columns: 80px repeat(7, 1fr); 
            width: 100%; height: 100%; background: white; overflow-y: auto;
        }
        .grid-header { background: #f1f1f1; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid #ddd; padding: 15px; text-align: center; font-weight: bold; }
        .time-cell { border-right: 1px solid #ddd; border-bottom: 1px solid #eee; height: 60px; color: #888; font-size: 0.7rem; text-align: right; padding-right: 10px; }
        .slot { border-right: 1px solid #eee; border-bottom: 1px solid #eee; height: 60px; position: relative; cursor: pointer; }
        .slot:hover { background: #fdf0f0; }
        .event { background: var(--cherry); color: white; font-size: 0.7rem; padding: 3px; border-radius: 3px; position: absolute; inset: 2px; }

    </style>
</head>
<body>

    <nav>
        <button onclick="switchTab('home')" id="tab-home">HOME</button>
        <button onclick="switchTab('planner')" id="tab-planner">PLANNER</button>
        <button onclick="switchTab('diary')" id="tab-diary">THE DIARY</button>
    </nav>

    <div class="main-container">
        <div id="home" class="view active">
            <h1 class="hero-title">ULTRAVIOLENCE</h1>
            <div class="polaroid-row">
                <div class="polaroid" style="transform:rotate(-3deg)">
                    <img src="Cadillac.png"><span>GETAWAY</span>
                </div>
                <div class="polaroid" style="transform:rotate(2deg)">
                    <img src="lanacig.png"><span>LANA</span>
                </div>
                <div class="polaroid" style="transform:rotate(-1deg)">
                    <img src="coke.png"><span>DIET SODA</span>
                </div>
            </div>
        </div>

        <div id="planner" class="view">
            <div class="planner-grid" id="plannerGrid">
                </div>
        </div>

        <div id="diary" class="view">
            <div class="diary-layout">
                <div class="sidebar">
                    <h2>ARCHIVES</h2>
                    <label>FONT STYLE</label>
                    <select id="fSelect" onchange="applyDiaryStyle()">
                        <option value="'Homemade Apple'">Handwritten</option>
                        <option value="'Special Elite'">Grunge</option>
                        <option value="'Courier Prime'">Typewriter</option>
                    </select>
                    <label>JUMP TO DATE</label>
                    <input type="date" id="dateInput" onchange="jumpToDate(this.value)">
                    <label>SEARCH</label>
                    <input type="text" placeholder="Search entries..." onkeyup="searchLogs(this.value)">
                    <div id="searchResults" style="font-size: 0.8rem; overflow-y: auto;"></div>
                </div>
                <div class="book-stage">
                    <div class="book" id="bookElement">
                        <div class="page page-left">
                            <h3 id="dateHeader" style="font-family:'Bebas Neue'; color:var(--cherry); margin:0 0 10px 0;"></h3>
                            <textarea id="textL" onkeyup="saveEntry()" placeholder="Dear Diary..."></textarea>
                        </div>
                        <div class="page">
                            <textarea id="textR" onkeyup="saveEntry()" placeholder="Continued..."></textarea>
                        </div>
                    </div>
                    <div style="position:absolute; bottom:20px; width:100%; display:flex; justify-content:center; gap:300px;">
                        <button onclick="changePage(-1)" style="background:#000; color:white; border:none; padding:10px 30px; cursor:pointer; font-family:'Bebas Neue';">PREVIOUS</button>
                        <button onclick="changePage(1)" style="background:#000; color:white; border:none; padding:10px 30px; cursor:pointer; font-family:'Bebas Neue';">NEXT</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentDay = new Date().toISOString().split('T')[0];
        let logs = JSON.parse(localStorage.getItem('uv_final_logs')) || {};
        let schedule = JSON.parse(localStorage.getItem('uv_final_plan')) || {};

        function switchTab(t) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-nav'));
            document.getElementById(t).classList.add('active');
            document.getElementById('tab-'+t).classList.add('active-nav');
            if(t === 'planner') buildPlanner();
            if(t === 'diary') loadEntry();
        }

        // --- PLANNER LOGIC ---
        function buildPlanner() {
            const g = document.getElementById('plannerGrid');
            g.innerHTML = `<div class="grid-header">GMT</div>`;
            const days = ['SUN','MON','TUE','WED','THU','FRI','SAT'];
            days.forEach(d => g.innerHTML += `<div class="grid-header">${d}</div>`);

            for(let h=0; h<24; h++) {
                g.innerHTML += `<div class="time-cell">${h}:00</div>`;
                for(let d=0; d<7; d++) {
                    let key = `${d}-${h}`;
                    let content = schedule[key] ? `<div class="event" onclick="deleteEv('${key}')">${schedule[key]}</div>` : '';
                    g.innerHTML += `<div class="slot" onclick="addEv('${key}')">${content}</div>`;
                }
            }
        }
        function addEv(k) { let v = prompt("New Event:"); if(v){ schedule[k]=v; savePlan(); } }
        function deleteEv(k) { event.stopPropagation(); if(confirm("Delete?")){ delete schedule[k]; savePlan(); } }
        function savePlan() { localStorage.setItem('uv_final_plan', JSON.stringify(schedule)); buildPlanner(); }

        // --- DIARY LOGIC ---
        function loadEntry() {
            const b = document.getElementById('bookElement');
            b.classList.add('turning'); // Start animation
            
            setTimeout(() => {
                document.getElementById('dateHeader').innerText = new Date(currentDay).toLocaleDateString('en-US', {month:'long', day:'numeric'}).toUpperCase();
                let data = logs[currentDay] || {l:"", r:""};
                document.getElementById('textL').value = data.l;
                document.getElementById('textR').value = data.r;
                b.classList.remove('turning'); // End animation
                applyDiaryStyle();
            }, 300);
        }

        function saveEntry() {
            logs[currentDay] = { l: document.getElementById('textL').value, r: document.getElementById('textR').value };
            localStorage.setItem('uv_final_logs', JSON.stringify(logs));
        }

        function changePage(n) {
            saveEntry();
            let d = new Date(currentDay); d.setDate(d.getDate() + n);
            currentDay = d.toISOString().split('T')[0];
            loadEntry();
        }

        function applyDiaryStyle() {
            const f = document.getElementById('fSelect').value;
            document.querySelectorAll('textarea').forEach(tx => tx.style.fontFamily = f);
        }

        function jumpToDate(v) { currentDay = v; loadEntry(); }
        
        function searchLogs(q) {
            const res = document.getElementById('searchResults'); res.innerHTML = "";
            if(q.length < 2) return;
            for(let d in logs) {
                if(logs[d].l.includes(q)) {
                    res.innerHTML += `<div style="padding:5px; cursor:pointer" onclick="jumpToDate('${d}')">â†’ ${d}</div>`;
                }
            }
        }
    </script>
</body>
</html>
