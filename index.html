<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ultraviolence | Daily Log</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Courier+Prime:wght@400;700&family=Playfair+Display:ital,wght@1,900&family=Homemade+Apple&family=Dancing+Script:wght@600&family=Special+Elite&display=swap');

        :root {
            --cherry: #8b0000;
            --cream: #f4f1ea;
            --leather: #3d2b1f;
        }

        body { background-color: var(--cream); margin: 0; padding: 0; font-family: 'Courier Prime', monospace; overflow-x: hidden; }

        /* NAV BAR */
        .nav-gate {
            background: #000; padding: 15px; display: flex; justify-content: center; gap: 40px;
            position: sticky; top: 0; z-index: 9999; border-bottom: 5px solid var(--cherry);
        }
        .nav-gate button {
            background: transparent; border: 1px solid white; color: white; padding: 8px 20px;
            font-family: 'Bebas Neue'; font-size: 1.5rem; cursor: pointer; transition: 0.3s;
        }
        .nav-gate button:hover { background: var(--cherry); border-color: var(--cherry); }

        .view { display: none; }
        .view.active { display: block; }

        /* DIARY VIEW */
        #diary-view {
            background: radial-gradient(circle, #5d4037 0%, #1a120d 100%);
            min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;
        }

        /* SEARCH SIDEBAR */
        .archive-side {
            width: 250px; background: rgba(0,0,0,0.4); height: 600px; padding: 20px;
            color: white; border-radius: 10px 0 0 10px; border-right: 2px solid var(--cherry);
            display: flex; flex-direction: column; gap: 15px;
        }
        .archive-side input { background: rgba(255,255,255,0.1); border: 1px solid #666; color: white; padding: 8px; border-radius: 5px; }
        .search-results { flex-grow: 1; overflow-y: auto; font-size: 0.8rem; margin-top: 10px; }
        .search-item { padding: 5px; cursor: pointer; border-bottom: 1px solid #444; }
        .search-item:hover { background: var(--cherry); }

        /* THE BOOK */
        .book-wrap { perspective: 1000px; }
        .book {
            width: 900px; height: 650px; background: #fff; display: flex;
            box-shadow: 0 50px 100px rgba(0,0,0,0.8); position: relative;
            transform-style: preserve-3d; transition: transform 0.5s;
        }
        .book-page {
            width: 50%; height: 100%; padding: 50px; box-sizing: border-box;
            background-color: #fdfaf0; border: 1px solid #ddd;
            background-image: linear-gradient(#e5e5e5 1px, transparent 1px);
            background-size: 100% 35px; line-height: 35px;
        }
        /* PAGE FLIP ANIMATION */
        .flipping { animation: pageFlip 0.6s ease-in-out; }
        @keyframes pageFlip {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(-10deg) scale(0.98); }
            100% { transform: rotateY(0deg); }
        }

        textarea { width: 100%; height: 100%; background: transparent; border: none; outline: none; resize: none; font-size: 1.3rem; }

        .book-controls {
            position: absolute; bottom: -60px; width: 100%; display: flex; justify-content: space-between;
        }
        .btn-flip { background: var(--cherry); color: white; border: none; padding: 10px 25px; font-family: 'Bebas Neue'; cursor: pointer; font-size: 1.2rem; }

        /* HOME PAGE STUFF (Preserved) */
        .home-grid { display: grid; grid-template-columns: 350px 1fr 300px; gap: 20px; padding: 30px; }
        .polaroid { background: white; padding: 10px 10px 40px 10px; box-shadow: 10px 10px 20px rgba(0,0,0,0.2); }
        .polaroid img { width: 100%; height: 250px; object-fit: cover; filter: grayscale(100%); }
    </style>
</head>
<body>

    <div class="nav-gate">
        <button onclick="changeView('home')">HOME</button>
        <button onclick="changeView('diary')">THE DIARY</button>
    </div>

    <div id="home" class="view active">
        <div class="home-grid">
            <div>
                <h1 style="font-family:'Bebas Neue'; font-size:4rem; color:var(--cherry);">ULTRA<br>VIOLENCE</h1>
                <div class="polaroid"><img src="Cadillac.png"></div>
            </div>
            <div style="background:white; padding:20px; border:3px solid #000;">
                <h2 style="font-family:'Bebas Neue';">LOGBOOK</h2>
                <div id="cal" style="display:grid; grid-template-columns: repeat(7, 1fr); border:1px solid #000;"></div>
            </div>
            <div><div class="polaroid"><img src="lanacig.png"></div></div>
        </div>
    </div>

    <div id="diary" class="view">
        <div id="diary-view">
            <div class="archive-side">
                <h3 style="font-family:'Bebas Neue'; margin:0;">ARCHIVES</h3>
                <label style="font-size:0.7rem;">JUMP TO DATE:</label>
                <input type="date" id="dateJump" onchange="jumpToDate(this.value)">
                
                <label style="font-size:0.7rem; margin-top:10px;">SEARCH WORDS:</label>
                <input type="text" placeholder="Find..." onkeyup="searchDiary(this.value)">
                <div class="search-results" id="searchResults"></div>
            </div>

            <div class="book-wrap">
                <div class="book" id="bookBody">
                    <div class="book-page">
                        <h2 id="pageDate" style="font-family:'Bebas Neue'; color:var(--cherry); margin:0;"></h2>
                        <textarea id="textLeft" onkeyup="save()" placeholder="Write here..."></textarea>
                    </div>
                    <div class="book-page">
                        <textarea id="textRight" onkeyup="save()" placeholder="Continued..."></textarea>
                    </div>
                    <div class="book-controls">
                        <button class="btn-flip" onclick="changeDay(-1)">PREVIOUS DAY</button>
                        <button class="btn-flip" onclick="changeDay(1)">NEXT DAY</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let curDate = new Date().toISOString().split('T')[0]; // Default to today
        let db = JSON.parse(localStorage.getItem('diary_v5')) || {};

        function changeView(v) {
            document.querySelectorAll('.view').forEach(e => e.classList.remove('active'));
            document.getElementById(v).classList.add('active');
            if(v === 'diary') loadDay();
        }

        function loadDay() {
            const b = document.getElementById('bookBody');
            b.classList.add('flipping');
            setTimeout(() => {
                const displayDate = new Date(curDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                document.getElementById('pageDate').innerText = displayDate.toUpperCase();
                
                const data = db[curDate] || {l: "", r: ""};
                document.getElementById('textLeft').value = data.l;
                document.getElementById('textRight').value = data.r;
                b.classList.remove('flipping');
            }, 300);
        }

        function save() {
            db[curDate] = {
                l: document.getElementById('textLeft').value,
                r: document.getElementById('textRight').value
            };
            localStorage.setItem('diary_v5', JSON.stringify(db));
        }

        function changeDay(dir) {
            let d = new Date(curDate);
            d.setDate(d.getDate() + dir);
            curDate = d.toISOString().split('T')[0];
            loadDay();
        }

        function jumpToDate(val) {
            if(!val) return;
            curDate = val;
            loadDay();
        }

        function searchDiary(query) {
            const results = document.getElementById('searchResults');
            results.innerHTML = "";
            if(query.length < 2) return;

            for(let date in db) {
                if(db[date].l.toLowerCase().includes(query.toLowerCase()) || db[date].r.toLowerCase().includes(query.toLowerCase())) {
                    const item = document.createElement('div');
                    item.className = 'search-item';
                    item.innerText = date;
                    item.onclick = () => jumpToDate(date);
                    results.appendChild(item);
                }
            }
        }

        // Init Home Calendar
        const cal = document.getElementById('cal');
        for(let i=1; i<=28; i++) {
            const d = document.createElement('div');
            d.style.height = "60px"; d.style.border = "1px solid #000"; d.innerText = i;
            cal.appendChild(d);
        }
    </script>
</body>
</html>
